@model SendMessageRequest
@using FaceLook.Services.Extensions

@{
	var showTitle = ViewData["ShowTitle"] as bool? ?? true;
	var formClass = ViewData["FormClass"] as string ?? "";
	var returnUrl = ViewData["ReturnUrl"] as string ?? "";
}

@if (showTitle)
{
	<div class="mb-4">
		<h3 class="text-white">
			<i class="bi bi-envelope-plus"></i> @(ViewData["FormTitle"] ?? "Send Message")
		</h3>
		@if (ViewData["FormSubtitle"] != null)
		{
			<p class="text-white opacity-75">@ViewData["FormSubtitle"]</p>
		}
	</div>
}

<form asp-controller="Messages" asp-action="@nameof(MessagesController.CreateMessage)" class="@formClass" method="post">
	<div asp-validation-summary="ModelOnly" class="alert alert-danger glass-card mb-3"></div>
    
	<input asp-for="SenderId" type="hidden" value="@User.GetUserId()" />
	@if (!string.IsNullOrEmpty(returnUrl))
	{
		<input type="hidden" name="returnUrl" value="@returnUrl" />
	}
    
	<div class="mb-3">
		<label asp-for="ReceiverEmail" class="form-label text-white mb-2">
			<i class="bi bi-person"></i> Recipient Email
		</label>
		<input asp-for="ReceiverEmail"
			   class="form-control glass-input"
			   placeholder="Enter recipient's email address" />
		<span asp-validation-for="ReceiverEmail" class="text-danger"></span>
	</div>
    
	<div class="mb-3">
		<label asp-for="Content" class="form-label text-white mb-2">
			<i class="bi bi-chat-text"></i> Your Message
		</label>
		<textarea asp-for="Content"
				  class="form-control glass-input"
				  rows="@(ViewData["MessageRows"] ?? 4)"
				  placeholder="Type your message here..."></textarea>
		<span asp-validation-for="Content" class="text-danger"></span>
	</div>
    
	<div class="d-flex gap-2">
		<button type="submit" class="btn glass-button">
			<i class="bi bi-send"></i> @(ViewData["SubmitButtonText"] ?? "Send Message")
		</button>
		@if (ViewData["ShowBackButton"] as bool? ?? false)
		{
			<a href="@returnUrl" class="btn glass-button">
				<i class="bi bi-arrow-left"></i> Back
			</a>
		}
	</div>
</form>
